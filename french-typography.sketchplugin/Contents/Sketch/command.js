var that=this;function __skpm_run(t,e){that.context=e;var u=function(t){var e={};function u(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,u),r.l=!0,r.exports}return u.m=t,u.c=e,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},u.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="",u(u.s=1)}([function(t,e,u){(function(e){function u(t,u){var r=Array.prototype.slice.call(u);r.forEach(function(t){try{log(e._skpmPrefix+function(){for(var t="",e=0;e<n;e++)t+="  ";n>0&&(t+="| ");return t}()+t)}catch(e){log(t)}})}e._skpmPrefix="console> ";var n=0;var r=e.group;e.group=function(){r&&r.apply(this,arguments),n+=1};var i=e.groupCollapsed;e.groupCollapsed=function(){i&&i.apply(this,arguments),n+=1};var a=e.groupEnd;e.groupEnd=function(){a&&a.apply(this,arguments),(n-=1)<0&&(n=0)};var o={},s=e.count;e.count=function(t){return o[t=void 0!==t?t:"Global"]=(o[t]||0)+1,s&&s.apply(this,arguments),u(0,[t+": "+o[t]])};var F={},c=e.time;e.time=function(t){if(c&&c.apply(this,arguments),F[t=void 0!==t?t:"default"])return u(0,['Timer "'+t+'" already exists']);F[t]=Date.now()};var l=e.timeEnd;e.timeEnd=function(t){if(l&&l.apply(this,arguments),!F[t=void 0!==t?t:"default"])return u(0,['Timer "'+t+'" does not exist']);var e=Date.now()-F[t];return delete F[t],u(0,[t+": "+e/1e3+"ms"])};var p=e.log;e.log=function(){return p&&p.apply(this,arguments),u(0,arguments)};var g=e.warn;e.warn=function(){return g&&g.apply(this,arguments),u(0,arguments)};var S=e.error;e.error=function(){return S&&S.apply(this,arguments),u(0,arguments)};var f=e.assert;e.assert=function(t,e){if(f&&f.apply(this,arguments),!t)return u(0,[e])};var N=e.info;e.info=function(){return N&&N.apply(this,arguments),u(0,arguments)};var E=e.clear;e.clear=function(){E&&E()},e._skpmEnabled=!0,t.exports=e}).call(e,u(0))},function(t,e,u){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.initPlugin=function(e){try{1==NSFileManager.defaultManager().fileExistsAtPath(e.plugin.urlForResourceNamed("debug").path())?r.setSettingForKey(f.DEBUG.ID,!0):r.setSettingForKey(f.DEBUG.ID,!1)}catch(e){t.error(e)}t.log(r.settingForKey(f.DEBUG.ID)),void 0==r.settingForKey(f.USE_NNBSP.ID)&&r.setSettingForKey(f.USE_NNBSP.ID,!1);void 0==r.settingForKey(f.AUTO_REPLACE.ID)&&r.setSettingForKey(f.AUTO_REPLACE.ID,!0)},e.replaceNNBSPbyWNBSP=N,e.replaceWNBSPbyNNBSP=E,e.createCheckbox=B,e.saveSettings=D,e.openSettings=function(t){var e=COSAlertWindow.alloc().init(),u=t.plugin.urlForResourceNamed("icon.png").path();e.setIcon(NSImage.alloc().initByReferencingFile(u)),e.setMessageText(o);var n=B(f.AUTO_REPLACE,NSMakeRect(0,0,250,23)),i=B(f.USE_NNBSP,NSMakeRect(25,0,300,56));return e.addAccessoryView(n),e.addAccessoryView(i),e.addButtonWithTitle("OK"),e.addButtonWithTitle("Cancel"),"1000"==e.runModal()?(D(f.AUTO_REPLACE,n),D(f.USE_NNBSP,i),void(r.settingForKey(f.USE_NNBSP.ID)?(s.NBSP=s.NNBSP,E()):(s.NBSP=s.WNBSP,N()))):void 0},e.replaceString=x,e.fixLayer=function(e){if(!r.settingForKey(f.AUTO_REPLACE.ID))return;if(!e.actionContext.old)throw new Error("unable to access selection");var u=new Date,i=n.fromNative(e.actionContext.layer),o=x(i.text);i.text=o.string;var F=o.count,c=new Date,l=(c.getTime()-u.getTime())/1e3;F>0&&r.settingForKey(f.DEBUG.ID)&&n.UI.message(String(F)+" substitution(s) done in "+l,a),r.settingForKey(f.USE_NNBSP.ID)&&RegExp(s.NNBSP).test(i)&&t.log("replaceWNBSPbyNNBSP n'a pas marché"),!r.settingForKey(f.USE_NNBSP.ID)&&RegExp(s.WNBSP).test(i)&&t.log("replaceNNBSPbyWNBSP n'a pas marché")};var n=u(2),r=u(3),i=u(4),a=n.getSelectedDocument(),o="French typography settings",s=e.U={ELLIPSIS:"…",SPACE:" ",WNBSP:" ",NNBSP:" ",OPENING_QUOTE:"«",CLOSING_QUOTE:"»"},F=/([0-9A-Z_a-z]+(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]?\xBB)?)([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]?)([!:;\?])([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|$)/g,c=/(\.{2,5})|(\. \. \.)/g,l=/("(?=[0-9A-Z_a-z]))|((?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|\^)"(?=(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])))/g,p=/(?:([0-9A-Z_a-z])")|(?:((?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))"(?=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|$))/g,g=/([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|^|'|\u2018|\u2019)(\xAB)([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]?)([0-9A-Z_a-z]+)/g,S=/(?:([0-9A-Z_a-z])\xBB)|(?:((?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))\xBB(?=[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|$))|(?:([0-9A-Z_a-z]|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF])\xBB)/g,f=e.settingsList={AUTO_REPLACE:{ID:"AUTO_REPLACE",label:" Automatic substitutions"},USE_NNBSP:{ID:"USE_NNBSP",label:" Narrow non-breakable spaces \n Resulting text is not compatible with Safari"},DEBUG:{ID:"USE_NNBSP"}};function N(t){i.searchInLayer(a,!0).forEach(function(t){var e=t.text.replace(RegExp(s.NNBSP,"gu"),s.WNBSP);t.text=e})}function E(t){i.searchInLayer(a,!0).forEach(function(t){var e=t.text.replace(RegExp(s.WNBSP,"gu"),s.NNBSP);t.text=e})}function B(t,e){var u=NSButton.alloc().initWithFrame(e);return u.setButtonType(NSSwitchButton),u.setBezelStyle(0),u.setTitle(t.label),r.settingForKey(t.ID)?u.setState(NSOnState):u.setState(NSOffState),u}function D(t,e){t.state=1==e.state(),r.setSettingForKey(t.ID,t.state)}function x(e){var u=0;return s.NBSP=1==r.settingForKey(f.USE_NNBSP.ID)?s.NNBSP:s.WNBSP,{string:e=e.replace(c,function(e){return t.log("points de suspension"),u++,s.ELLIPSIS}).replace(/([^0-9]\s)--?(\s?[^0-9])/,function(e,n,r,i){return t.log("incises intelligentes"),u++,String(n)+"–"+String(n)}).replace(/(^|\n|\r)--?/,function(e,n){return t.log("puces en début de ligne"),u++,"–"}).replace(/n°/,function(e,n,r,i){return u++,t.log("n°"),"№"}).replace(/(\s|\w|^)1\/2(\s|\w|$)/,function(e,n,r){return u++,t.log("1/2"),String(n)+"½"+String(r)}).replace(/(\s|\w|^)1\/3(\s|\w|$)/,function(e,n,r){return u++,t.log("1/3"),String(n)+"⅓"+String(r)}).replace(/(\s|\w|^)1\/4(\s|\w|$)/,function(e,n,r){return u++,t.log("1/4"),String(n)+"¼"+String(r)}).replace(/\b1er?\b/,function(e,n,r){return u++,t.log("1er --\x3e ordinal en exposant"),"1ᵉʳ"}).replace(/(?!1\b)(\d+)e\b/,function(e,n,r){return u++,t.log("2e --\x3e ordinal en exposant"),String(n)+"ᵉ"}).replace(l,function(t,e,n){u++;var r=n||"";return s.OPENING_QUOTE+r}).replace(p,function(t,e,n){return u++,(e||n||"")+s.CLOSING_QUOTE}).replace(g,function(e,n,r,i,a){return t.log("//après «"),u++,n+r+s.NBSP+a}).replace(F,function(e,n,r,i,a){return t.log("espaces fines insécables avant ? ! ; :"),u++,n+s.NBSP+i+a}).replace(S,function(e,n,r){t.log("//avant »"),u++;var i=n||r||"";return t.log("adj : ",i),i+s.NBSP+s.CLOSING_QUOTE}).replace(/(\d+)\s?\%/,function(e,n,r){return t.log("//avant %"),u++,""+String(n)+String(s.NBSP)+"%"}).replace(/(\d+)\s?([$£€])/,function(e,n,r,i){return t.log("/avant $£€"),u++,""+String(n)+String(s.NBSP)+String(r)}),count:u}}}).call(e,u(0))},function(t,e){t.exports=require("sketch")},function(t,e){t.exports=require("sketch/settings")},function(t,e,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.searchInLayer=function t(e,u){switch(e.type){case"Text":n.push(e);break;case"Document":for(var r=e.pages,i=0;i<[r.length];i++)t(r[i],!1);break;case"Page":case"Group":case"Artboard":for(var a=e.layers,i=0;i<[a.length];i++)t(a[i],!1);break;case MSSymbolMaster:if(1!=u)break;for(var a=e.layers,i=0;i<[a.length];i++)t(a[i],u)}return n};var n=[]}]);"default"===t&&"function"==typeof u?u(e):u[t](e)}that.fixLayer=__skpm_run.bind(this,"fixLayer"),that.onRun=__skpm_run.bind(this,"default"),that.initPlugin=__skpm_run.bind(this,"initPlugin"),that.use_NNBSP=__skpm_run.bind(this,"use_NNBSP"),that.openSettings=__skpm_run.bind(this,"openSettings");