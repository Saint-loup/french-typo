{"version":3,"sources":["webpack://exports/webpack/bootstrap","webpack://exports/./src/command.js","webpack://exports/./src/utils.js","webpack://exports/external \"sketch\"","webpack://exports/external \"sketch/settings\""],"names":["sketch","require","Settings","searchAllTextLayers","document","getSelectedDocument","LABEL_POPIN_TITLE","LABEL_AUTO_REPLACE","LABEL_USE_NNBSP","U","ELLIPSIS","SPACE","WNBSP","NNBSP","OPENING_QUOTE","CLOSING_QUOTE","NBSP_DOUBLE_PUNCTUATION","REGEX_ELLIPSIS","DOUBLE_QUOTE_OPEN","DOUBLE_QUOTE_CLOSE","NBSP_AFTER_QUOTE","NBSP_BEFORE_QUOTE","ANY_NUMBER_EXCEPT_ONE","settingsList","AUTO_REPLACE","ID","label","USE_NNBSP","DEBUG","initPlugin","context","NSFileManager","defaultManager","fileExistsAtPath","plugin","urlForResourceNamed","path","setSettingForKey","console","log","settingForKey","error","undefined","replaceNNBSPbyWNBSP","textLayers","searchInLayer","forEach","layer","newText","text","replace","RegExp","replaceWNBSPbyNNBSP","createCheckbox","setting","frame","checkbox","NSButton","alloc","initWithFrame","setButtonType","NSSwitchButton","setBezelStyle","setTitle","setState","NSOnState","NSOffState","saveSettings","state","openSettings","dialogWindow","COSAlertWindow","init","pluginIconPath","setIcon","NSImage","initByReferencingFile","setMessageText","checkboxAutoReplace","NSMakeRect","checkboxUseNNBSP","addAccessoryView","addButtonWithTitle","response","runModal","NBSP","replaceString","string","count","match","$1","$2","$3","adj","$4","fixLayer","autoReplaceActivated","startDate","Date","selection","selectedLayers","layers","endDate","duration","getTime","UI","message","test","inSymbolMaster","type","push","documentPages","pages","i","length","sublayers","MSSymbolMaster"],"mappings":";;;;;;;;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,IAAMA,MAAM,GAAGC,mBAAO,CAAC,sBAAD,CAAtB;;AACA,IAAMC,QAAQ,GAAGD,mBAAO,CAAC,wCAAD,CAAxB;;AACA,IAAME,mBAAmB,GAAGF,mBAAO,CAAC,kCAAD,CAAnC;;AACA,IAAMG,QAAQ,GAAGJ,MAAM,CAACK,mBAAP,EAAjB,C,CAEA;;AACA,IAAMC,iBAAiB,GAAG,4BAA1B;AACA,IAAMC,kBAAkB,GAAG,0BAA3B;AACA,IAAMC,eAAe,GACnB,8EADF,C,CAGA;;AACO,IAAMC,CAAC,GAAG;AACfC,UAAQ,EAAE,QADK;AAEfC,OAAK,EAAE,GAFQ;AAEE;AACjBC,OAAK,EAAE,MAHQ;AAGE;AACjBC,OAAK,EAAE,QAJQ;AAIE;AACjBC,eAAa,EAAE,GALA;AAMfC,eAAa,EAAE;AANA,CAAV,C,CAQP;;AACA,IAAMC,uBAAuB,GAAG,qPAAhC;AACA,IAAMC,cAAc,GAAG,uBAAvB;AACA,IAAMC,iBAAiB,GAAG,+VAA1B;AACA,IAAMC,kBAAkB,GAAG,8VAA3B;AACA,IAAMC,gBAAgB,GAAG,qLAAzB;AACA,IAAMC,iBAAiB,GAAG,+bAA1B;AACA,IAAMC,qBAAqB,GAAG,YAA9B,C,CAEA;;AAEO,IAAMC,YAAY,GAAG;AAC1BC,cAAY,EAAE;AACZC,MAAE,EAAE,cADQ;AAEZC,SAAK,EAAEnB;AAFK,GADY;AAK1BoB,WAAS,EAAE;AACTF,MAAE,EAAE,WADK;AAETC,SAAK,EAAElB;AAFE,GALe;AAS1BoB,OAAK,EAAE;AACLH,MAAE,EAAE;AADC;AATmB,CAArB;AAcA,SAASI,UAAT,CAAoBC,OAApB,EAA6B;AAClC,MAAI;AACF,QACEC,aAAa,CAACC,cAAd,GAA+BC,gBAA/B,CACEH,OAAO,CAACI,MAAR,CAAeC,mBAAf,CAAmC,OAAnC,EAA4CC,IAA5C,EADF,KAEK,CAHP,EAIE;AACAlC,cAAQ,CAACmC,gBAAT,CAA0Bd,YAAY,CAACK,KAAb,CAAmBH,EAA7C,EAAiD,IAAjD;AACAa,aAAO,CAACC,GAAR,CACE,kBAAkBrC,QAAQ,CAACsC,aAAT,CAAuBjB,YAAY,CAACK,KAAb,CAAmBH,EAA1C,CADpB;AAGD;AACF,GAXD,CAWE,OAAOgB,KAAP,EAAc;AACdH,WAAO,CAACC,GAAR,CAAY,kBAAkBrC,QAAQ,CAACsC,aAAT,CAAuBjB,YAAY,CAACK,KAAb,CAAmBH,EAA1C,CAA9B;AACAvB,YAAQ,CAACmC,gBAAT,CAA0Bd,YAAY,CAACK,KAAb,CAAmBH,EAA7C,EAAiD,KAAjD;AACD;;AAED,MAAIvB,QAAQ,CAACsC,aAAT,CAAuBjB,YAAY,CAACC,YAAb,CAA0BC,EAAjD,KAAwDiB,SAA5D,EAAuE;AACrEJ,WAAO,CAACC,GAAR,CAAY,oBAAZ;AAEArC,YAAQ,CAACmC,gBAAT,CAA0Bd,YAAY,CAACC,YAAb,CAA0BC,EAApD,EAAwD,IAAxD;AACD;;AAED,MAAIvB,QAAQ,CAACsC,aAAT,CAAuBjB,YAAY,CAACI,SAAb,CAAuBF,EAA9C,KAAqDiB,SAAzD,EAAoE;AAClExC,YAAQ,CAACmC,gBAAT,CAA0Bd,YAAY,CAACI,SAAb,CAAuBF,EAAjD,EAAqD,KAArD;AACD;AACF;AAEM,SAASkB,mBAAT,CAA6Bb,OAA7B,EAAsC;AAC3C,MAAIc,UAAU,GAAGzC,mBAAmB,CAAC0C,aAApB,CAAkCzC,QAAlC,EAA4C,IAA5C,CAAjB;AACAwC,YAAU,CAACE,OAAX,CAAmB,UAASC,KAAT,EAAgB;AACjC,QAAIC,OAAO,GAAGD,KAAK,CAACE,IAAN,CAAWC,OAAX,CAAmBC,MAAM,CAAC1C,CAAC,CAACI,KAAH,EAAU,IAAV,CAAzB,EAA0CJ,CAAC,CAACG,KAA5C,CAAd;AACAmC,SAAK,CAACE,IAAN,GAAaD,OAAb;AACD,GAHD;AAID;AAEM,SAASI,mBAAT,CAA6BtB,OAA7B,EAAsC;AAC3C,MAAIc,UAAU,GAAGzC,mBAAmB,CAAC0C,aAApB,CAAkCzC,QAAlC,EAA4C,IAA5C,CAAjB;AACAwC,YAAU,CAACE,OAAX,CAAmB,UAASC,KAAT,EAAgB;AACjC,QAAIC,OAAO,GAAGD,KAAK,CAACE,IAAN,CAAWC,OAAX,CAAmBC,MAAM,CAAC1C,CAAC,CAACG,KAAH,EAAU,IAAV,CAAzB,EAA0CH,CAAC,CAACI,KAA5C,CAAd;AACAkC,SAAK,CAACE,IAAN,GAAaD,OAAb;AACD,GAHD;AAID;AAEM,SAASK,cAAT,CAAwBC,OAAxB,EAAiCC,KAAjC,EAAwC;AAC7C,MAAIC,QAAQ,GAAGC,QAAQ,CAACC,KAAT,GAAiBC,aAAjB,CAA+BJ,KAA/B,CAAf;AACAC,UAAQ,CAACI,aAAT,CAAuBC,cAAvB;AACAL,UAAQ,CAACM,aAAT,CAAuB,CAAvB;AACAN,UAAQ,CAACO,QAAT,CAAkBT,OAAO,CAAC5B,KAA1B;;AAEA,MAAIxB,QAAQ,CAACsC,aAAT,CAAuBc,OAAO,CAAC7B,EAA/B,CAAJ,EAAwC;AACtC+B,YAAQ,CAACQ,QAAT,CAAkBC,SAAlB;AACD,GAFD,MAEO;AACLT,YAAQ,CAACQ,QAAT,CAAkBE,UAAlB;AACD;;AACD,SAAOV,QAAP;AACD;AAEM,SAASW,YAAT,CAAsBb,OAAtB,EAA+BE,QAA/B,EAAyC;AAC9CF,SAAO,CAACc,KAAR,GAAgBZ,QAAQ,CAACY,KAAT,MAAoB,IAApC;AACAlE,UAAQ,CAACmC,gBAAT,CAA0BiB,OAAO,CAAC7B,EAAlC,EAAsC6B,OAAO,CAACc,KAA9C;AACD,C,CAED;;AACO,SAASC,YAAT,CAAsBvC,OAAtB,EAA+B;AACpC,MAAIwC,YAAY,GAAGC,cAAc,CAACb,KAAf,GAAuBc,IAAvB,EAAnB;AACA,MAAIC,cAAc,GAAG3C,OAAO,CAACI,MAAR,CAAeC,mBAAf,CAAmC,UAAnC,EAA+CC,IAA/C,EAArB;AACAkC,cAAY,CAACI,OAAb,CAAqBC,OAAO,CAACjB,KAAR,GAAgBkB,qBAAhB,CAAsCH,cAAtC,CAArB;AACAH,cAAY,CAACO,cAAb,CAA4BvE,iBAA5B;AAEA,MAAIwE,mBAAmB,GAAGzB,cAAc,CACtC9B,YAAY,CAACC,YADyB,EAEtCuD,UAAU,CAAC,CAAD,EAAI,CAAJ,EAAO,GAAP,EAAY,EAAZ,CAF4B,CAAxC;AAIA,MAAIC,gBAAgB,GAAG3B,cAAc,CACnC9B,YAAY,CAACI,SADsB,EAEnCoD,UAAU,CAAC,EAAD,EAAK,CAAL,EAAQ,GAAR,EAAa,EAAb,CAFyB,CAArC;AAIAT,cAAY,CAACW,gBAAb,CAA8BH,mBAA9B;AACAR,cAAY,CAACW,gBAAb,CAA8BD,gBAA9B,EAfoC,CAiBpC;;AACAV,cAAY,CAACY,kBAAb,CAAgC,IAAhC;AACAZ,cAAY,CAACY,kBAAb,CAAgC,QAAhC;AAEA,MAAIC,QAAQ,GAAGb,YAAY,CAACc,QAAb,EAAf;;AACA,MAAID,QAAQ,IAAI,MAAhB,EAAwB;AACtBhB,gBAAY,CAAC5C,YAAY,CAACC,YAAd,EAA4BsD,mBAA5B,CAAZ;AACAX,gBAAY,CAAC5C,YAAY,CAACI,SAAd,EAAyBqD,gBAAzB,CAAZ;;AAEA,QAAI9E,QAAQ,CAACsC,aAAT,CAAuBjB,YAAY,CAACI,SAAb,CAAuBF,EAA9C,CAAJ,EAAuD;AACrDhB,OAAC,CAAC4E,IAAF,GAAS5E,CAAC,CAACI,KAAX;AACAuC,yBAAmB;AACpB,KAHD,MAGO;AACL3C,OAAC,CAAC4E,IAAF,GAAS5E,CAAC,CAACG,KAAX;AACA+B,yBAAmB;AACpB;;AAED;AACD,GAbD,MAaO;AACL;AACD;AACF;AAEM,SAAS2C,aAAT,CAAuBC,MAAvB,EAA+B;AACpC,MAAIC,KAAK,GAAG,CAAZ,CADoC,CAEpC;;AACA/E,GAAC,CAAC4E,IAAF,GACEnF,QAAQ,CAACsC,aAAT,CAAuBjB,YAAY,CAACI,SAAb,CAAuBF,EAA9C,KAAqD,IAArD,GACIhB,CAAC,CAACI,KADN,GAEIJ,CAAC,CAACG,KAHR;AAKA2E,QAAM,GAAGA,MAAM,CACZrC,OADM,EAEL;AAEA;AAEAjC,gBANK,EAOL,UAAAwE,KAAK,EAAI;AACPnD,WAAO,CAACC,GAAR,CAAY,sBAAZ;AACAiD,SAAK;AACL,WAAO/E,CAAC,CAACC,QAAT;AACD,GAXI,EAaP;AAbO,GAcNwC,OAdM,CAcE,0BAdF,EAc8B,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAuB;AAC1DtD,WAAO,CAACC,GAAR,CAAY,uBAAZ;AACAiD,SAAK;AACL,qBAAUE,EAAV,mBAAgBA,EAAhB;AACD,GAlBM,EAmBP;AAnBO,GAoBNxC,OApBM,CAoBE,cApBF,EAoBkB,UAACuC,KAAD,EAAQC,EAAR,EAAe;AACtCpD,WAAO,CAACC,GAAR,CAAY,yBAAZ;AACAiD,SAAK;AACL,WAAO,GAAP;AACD,GAxBM,EAyBP;AAzBO,GA0BNtC,OA1BM,CA0BE,IA1BF,EA0BQ,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAuB;AACpCJ,SAAK;AACLlD,WAAO,CAACC,GAAR,CAAY,IAAZ;AACA,WAAO,GAAP;AACD,GA9BM,EA+BP;AA/BO,GAgCNW,OAhCM,CAgCE,wBAhCF,EAgC4B,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAmB;AACpDH,SAAK;AACLlD,WAAO,CAACC,GAAR,CAAY,KAAZ;AACA,qBAAUmD,EAAV,iBAAgBC,EAAhB;AACD,GApCM,EAqCNzC,OArCM,CAqCE,wBArCF,EAqC4B,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAmB;AACpDH,SAAK;AACLlD,WAAO,CAACC,GAAR,CAAY,KAAZ;AACA,qBAAUmD,EAAV,mBAAgBC,EAAhB;AACD,GAzCM,EA0CNzC,OA1CM,CA0CE,wBA1CF,EA0C4B,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAmB;AACpDH,SAAK;AACLlD,WAAO,CAACC,GAAR,CAAY,KAAZ;AACA,qBAAUmD,EAAV,iBAAgBC,EAAhB;AACD,GA9CM,EA+CP;AA/CO,GAgDNzC,OAhDM,CAgDE,UAhDF,EAgDc,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAmB;AACtCH,SAAK;AACLlD,WAAO,CAACC,GAAR,CAAY,6BAAZ;AACA;AACD,GApDM,EAqDP;AArDO,GAsDNW,OAtDM,CAsDE,iBAtDF,EAsDqB,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAmB;AAC7CH,SAAK;AACLlD,WAAO,CAACC,GAAR,CAAY,4BAAZ;AACA,qBAAUmD,EAAV;AACD,GA1DM,EA2DNxC,OA3DM,CA2DE,QA3DF,EA2DY,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAuB;AACxCtD,WAAO,CAACC,GAAR,CAAY,wCAAZ;AACAiD,SAAK;AACL,WAAOE,EAAE,GAAG,QAAZ;AACD,GA/DM,EAgEP;AAEA;AAlEO,GAmENxC,OAnEM,CAmEEhC,iBAnEF,EAmEqB,UAACuE,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAmB;AAC7CH,SAAK;AAEL,QAAIK,GAAG,GAAGF,EAAE,IAAI,EAAhB,CAH6C,CAI7C;;AACA,WAAOlF,CAAC,CAACK,aAAF,GAAkB+E,GAAzB;AACD,GAzEM,EA0EP;AA1EO,GA2EN3C,OA3EM,CA2EE/B,kBA3EF,EA2EsB,UAACsE,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAmB;AAC9CH,SAAK;AACL,QAAIK,GAAG,GAAGH,EAAE,IAAIC,EAAN,IAAY,EAAtB;AACA,WAAOE,GAAG,GAAGpF,CAAC,CAACM,aAAf;AACD,GA/EM,EAgFP;AAhFO,GAiFNmC,OAjFM,CAiFE9B,gBAjFF,EAiFoB,UAACqE,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAoBE,EAApB,EAA2B;AACpDxD,WAAO,CAACC,GAAR,CAAY,WAAZ;AACAiD,SAAK;AACL,WAAOE,EAAE,GAAGC,EAAL,GAAUlF,CAAC,CAAC4E,IAAZ,GAAmBS,EAA1B;AACD,GArFM,EAsFP;AAtFO,GAuFN5C,OAvFM,CAuFElC,uBAvFF,EAuF2B,UAACyE,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAoBE,EAApB,EAA2B;AAC3DxD,WAAO,CAACC,GAAR,CAAY,wCAAZ;AACAiD,SAAK;AACL,WAAOE,EAAE,GAAGjF,CAAC,CAAC4E,IAAP,GAAcO,EAAd,GAAmBE,EAA1B;AACD,GA3FM,EA4FP;AA5FO,GA6FN5C,OA7FM,CA6FE7B,iBA7FF,EA6FqB,UAACoE,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAmB;AAC7CrD,WAAO,CAACC,GAAR,CAAY,WAAZ;AACAiD,SAAK;AACL,QAAIK,GAAG,GAAGH,EAAE,IAAIC,EAAN,IAAY,EAAtB;AACArD,WAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBsD,GAAtB;AACA,WAAOA,GAAG,GAAGpF,CAAC,CAAC4E,IAAR,GAAe5E,CAAC,CAACM,aAAxB;AACD,GAnGM,EAoGP;AApGO,GAqGNmC,OArGM,CAqGE,YArGF,EAqGgB,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAmB;AACxCrD,WAAO,CAACC,GAAR,CAAY,WAAZ;AACAiD,SAAK;AACL,qBAAUE,EAAV,SAAejF,CAAC,CAAC4E,IAAjB;AACD,GAzGM,EA0GP;AA1GO,GA2GNnC,OA3GM,CA2GE,iBA3GF,EA2GqB,UAACuC,KAAD,EAAQC,EAAR,EAAYC,EAAZ,EAAgBC,EAAhB,EAAuB;AACjDtD,WAAO,CAACC,GAAR,CAAY,YAAZ;AACAiD,SAAK;AACL,qBAAUE,EAAV,SAAejF,CAAC,CAAC4E,IAAjB,SAAwBM,EAAxB;AACD,GA/GM,CAAT,CARoC,CAwHpC;AACA;AACA;AACA;AACA;;AAEA,SAAO;AACLJ,UAAM,EAAEA,MADH;AAELC,SAAK,EAAEA;AAFF,GAAP;AAID,C,CAED;;AACO,SAASO,QAAT,CAAkBjE,OAAlB,EAA2B;AAChC;AACA,MAAIkE,oBAAoB,GAAG9F,QAAQ,CAACsC,aAAT,CACzBjB,YAAY,CAACC,YAAb,CAA0BC,EADD,CAA3B;;AAIA,MAAI,CAACuE,oBAAL,EAA2B;AACzB;AACD;;AAED,MAAMC,SAAS,GAAG,IAAIC,IAAJ,EAAlB,CAVgC,CAWhC;;AACA,MAAIC,SAAS,GAAG/F,QAAQ,CAACgG,cAAT,CAAwBC,MAAxB,CAA+B,CAA/B,CAAhB;AACA/D,SAAO,CAACC,GAAR,CAAY4D,SAAZ;AACA,MAAInD,OAAO,GAAGsC,aAAa,CAACa,SAAS,CAAClD,IAAX,CAA3B;AACAkD,WAAS,CAAClD,IAAV,GAAiBD,OAAO,CAACuC,MAAzB;AAEA,MAAIC,KAAK,GAAGxC,OAAO,CAACwC,KAApB;AACA,MAAMc,OAAO,GAAG,IAAIJ,IAAJ,EAAhB;AACA,MAAMK,QAAQ,GAAG,CAACD,OAAO,CAACE,OAAR,KAAoBP,SAAS,CAACO,OAAV,EAArB,IAA4C,IAA7D;;AACA,MAAIhB,KAAK,GAAG,CAAR,IAAatF,QAAQ,CAACsC,aAAT,CAAuBjB,YAAY,CAACK,KAAb,CAAmBH,EAA1C,CAAjB,EAAgE;AAC9DzB,UAAM,CAACyG,EAAP,CAAUC,OAAV,WAAqBlB,KAArB,sCAAsDe,QAAtD,GAAkEnG,QAAlE;AACD;;AAED,MACEF,QAAQ,CAACsC,aAAT,CAAuBjB,YAAY,CAACI,SAAb,CAAuBF,EAA9C,KACA0B,MAAM,CAAC1C,CAAC,CAACI,KAAH,CAAN,CAAgB8F,IAAhB,CAAqBR,SAArB,CAFF,EAGE;AACA7D,WAAO,CAACC,GAAR,CAAY,oCAAZ;AACD;;AACD,MACE,CAACrC,QAAQ,CAACsC,aAAT,CAAuBjB,YAAY,CAACI,SAAb,CAAuBF,EAA9C,CAAD,IACA0B,MAAM,CAAC1C,CAAC,CAACG,KAAH,CAAN,CAAgB+F,IAAhB,CAAqBR,SAArB,CAFF,EAGE;AACA7D,WAAO,CAACC,GAAR,CAAY,oCAAZ;AACD;AACF,C;;;;;;;;;;;;AC1UD;AAAA;AAAA;AACA;AAEA,IAAIK,UAAU,GAAG,EAAjB;AACO,SAASC,aAAT,CAAuBE,KAAvB,EAA8B6D,cAA9B,EAA8C;AACnD;AAEA,UAAQ7D,KAAK,CAAC8D,IAAd;AACE;AACA,SAAK,MAAL;AACE;AAEAjE,gBAAU,CAACkE,IAAX,CAAgB/D,KAAhB;AAEA;AAEF;;AACA,SAAK,UAAL;AACE,UAAIgE,aAAa,GAAGhE,KAAK,CAACiE,KAA1B;;AACA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAACF,aAAa,CAACG,MAAf,CAApB,EAA4CD,CAAC,EAA7C,EAAiD;AAC/CpE,qBAAa,CAACkE,aAAa,CAACE,CAAD,CAAd,EAAmB,KAAnB,CAAb;AACD;;AACD;AAEF;;AACA,SAAK,MAAL;AACA,SAAK,OAAL;AACA,SAAK,UAAL;AACE,UAAIE,SAAS,GAAGpE,KAAK,CAACsD,MAAtB;;AACA,WAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAACE,SAAS,CAACD,MAAX,CAApB,EAAwCD,CAAC,EAAzC,EAA6C;AAC3CpE,qBAAa,CAACsE,SAAS,CAACF,CAAD,CAAV,EAAe,KAAf,CAAb;AACD;;AACD;;AAEF,SAAKG,cAAL;AACE,UAAIR,cAAc,IAAI,IAAtB,EAA4B;AAC5B,UAAIO,SAAS,GAAGpE,KAAK,CAACsD,MAAtB;;AACA,WAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAACE,SAAS,CAACD,MAAX,CAApB,EAAwCD,CAAC,EAAzC,EAA6C;AAC3CpE,qBAAa,CAACsE,SAAS,CAACF,CAAD,CAAV,EAAeL,cAAf,CAAb;AACD;;AACD;AAEF;AACA;AACA;AArCF;;AAuCA,SAAOhE,UAAP;AACD,C,CAED;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,I;;;;;;;;;;;AClFA,mC;;;;;;;;;;;ACAA,4C","file":"__command.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/command.js\");\n","//TODO\n// Ajouter licence\n\n// Scénario de test\n// J'installe le plugin depuis le repo officiel\n// J'insère t\", le guillemet est bien remplacé\n// j'ouvre les settings. setting 1 : activé, setting 2 : désactivé.\n//je crée du texte dans plusieurs pages. je change le setting 2. tous les espaces sont bien remplacés.\n// je ferme  rouvre les settings, ils sont bien conservés.\n// je ferme sketch et les reouvre, idem\n// Aucun message n'apparait en bas de l'écran lors des remplacements.\n\nconst sketch = require('sketch')\nconst Settings = require('sketch/settings')\nconst searchAllTextLayers = require('./utils.js')\nconst document = sketch.getSelectedDocument()\n\n// LABELS\nconst LABEL_POPIN_TITLE = 'French typography settings'\nconst LABEL_AUTO_REPLACE = ' Automatic substitutions'\nconst LABEL_USE_NNBSP =\n  ' Narrow non-breakable spaces \\n Resulting text is not compatible with Safari'\n\n// CHARACTER CONSTANTS\nexport const U = {\n  ELLIPSIS: '\\u2026',\n  SPACE: '\\u0020', // Good ol' space\n  WNBSP: '\\u00A0', // wide non breakable space\n  NNBSP: '\\u202F', // narrow non breakable space\n  OPENING_QUOTE: '«',\n  CLOSING_QUOTE: '»',\n}\n// REGEXs\nconst NBSP_DOUBLE_PUNCTUATION = /(\\w+(?:\\s?»)?)(\\s?)([?!;:])(\\s|$)/gu\nconst REGEX_ELLIPSIS = /(\\.{2,5})|(\\. \\. \\.)/gu\nconst DOUBLE_QUOTE_OPEN = /(\"(?=\\w))|((?:\\s|\\^)\"(?=\\S))/gu\nconst DOUBLE_QUOTE_CLOSE = /(?:(\\w)\")|(?:(\\S)\"(?=\\s|$))/gu\nconst NBSP_AFTER_QUOTE = /(\\s|^|'|‘|’)(«)(\\s?)(\\w+)/gu\nconst NBSP_BEFORE_QUOTE = /(?:(\\w)»)|(?:(\\S)»(?=\\s|$))|(?:(\\w|\\s)»)/gu\nconst ANY_NUMBER_EXCEPT_ONE = /(?!1\\b)d+/gu\n\n// SETTINGS\n\nexport const settingsList = {\n  AUTO_REPLACE: {\n    ID: 'AUTO_REPLACE',\n    label: LABEL_AUTO_REPLACE,\n  },\n  USE_NNBSP: {\n    ID: 'USE_NNBSP',\n    label: LABEL_USE_NNBSP,\n  },\n  DEBUG: {\n    ID: 'DEBUG',\n  },\n}\n\nexport function initPlugin(context) {\n  try {\n    if (\n      NSFileManager.defaultManager().fileExistsAtPath(\n        context.plugin.urlForResourceNamed('debug').path()\n      ) == 1\n    ) {\n      Settings.setSettingForKey(settingsList.DEBUG.ID, true)\n      console.log(\n        'debug mode : ' + Settings.settingForKey(settingsList.DEBUG.ID)\n      )\n    }\n  } catch (error) {\n    console.log('debug mode : ' + Settings.settingForKey(settingsList.DEBUG.ID))\n    Settings.setSettingForKey(settingsList.DEBUG.ID, false)\n  }\n\n  if (Settings.settingForKey(settingsList.AUTO_REPLACE.ID) == undefined) {\n    console.log(\"test d'undef passé\")\n\n    Settings.setSettingForKey(settingsList.AUTO_REPLACE.ID, true)\n  }\n\n  if (Settings.settingForKey(settingsList.USE_NNBSP.ID) == undefined) {\n    Settings.setSettingForKey(settingsList.USE_NNBSP.ID, false)\n  }\n}\n\nexport function replaceNNBSPbyWNBSP(context) {\n  let textLayers = searchAllTextLayers.searchInLayer(document, true)\n  textLayers.forEach(function(layer) {\n    let newText = layer.text.replace(RegExp(U.NNBSP, 'gu'), U.WNBSP)\n    layer.text = newText\n  })\n}\n\nexport function replaceWNBSPbyNNBSP(context) {\n  let textLayers = searchAllTextLayers.searchInLayer(document, true)\n  textLayers.forEach(function(layer) {\n    let newText = layer.text.replace(RegExp(U.WNBSP, 'gu'), U.NNBSP)\n    layer.text = newText\n  })\n}\n\nexport function createCheckbox(setting, frame) {\n  let checkbox = NSButton.alloc().initWithFrame(frame)\n  checkbox.setButtonType(NSSwitchButton)\n  checkbox.setBezelStyle(0)\n  checkbox.setTitle(setting.label)\n\n  if (Settings.settingForKey(setting.ID)) {\n    checkbox.setState(NSOnState)\n  } else {\n    checkbox.setState(NSOffState)\n  }\n  return checkbox\n}\n\nexport function saveSettings(setting, checkbox) {\n  setting.state = checkbox.state() == true\n  Settings.setSettingForKey(setting.ID, setting.state)\n}\n\n// fonction qui ouvre un menu de paramètres depuis le menu.\nexport function openSettings(context) {\n  let dialogWindow = COSAlertWindow.alloc().init()\n  let pluginIconPath = context.plugin.urlForResourceNamed('icon.png').path()\n  dialogWindow.setIcon(NSImage.alloc().initByReferencingFile(pluginIconPath))\n  dialogWindow.setMessageText(LABEL_POPIN_TITLE)\n\n  let checkboxAutoReplace = createCheckbox(\n    settingsList.AUTO_REPLACE,\n    NSMakeRect(0, 0, 250, 23)\n  )\n  let checkboxUseNNBSP = createCheckbox(\n    settingsList.USE_NNBSP,\n    NSMakeRect(25, 0, 300, 56)\n  )\n  dialogWindow.addAccessoryView(checkboxAutoReplace)\n  dialogWindow.addAccessoryView(checkboxUseNNBSP)\n\n  // labels seem hardcoded: shortcuts like ESC don't work with any other labels.\n  dialogWindow.addButtonWithTitle('OK')\n  dialogWindow.addButtonWithTitle('Cancel')\n\n  let response = dialogWindow.runModal()\n  if (response == '1000') {\n    saveSettings(settingsList.AUTO_REPLACE, checkboxAutoReplace)\n    saveSettings(settingsList.USE_NNBSP, checkboxUseNNBSP)\n\n    if (Settings.settingForKey(settingsList.USE_NNBSP.ID)) {\n      U.NBSP = U.NNBSP\n      replaceWNBSPbyNNBSP()\n    } else {\n      U.NBSP = U.WNBSP\n      replaceNNBSPbyWNBSP()\n    }\n\n    return\n  } else {\n    return\n  }\n}\n\nexport function replaceString(string) {\n  let count = 0\n  //On vérifie le charactère choisi par l'utilisateur comme espace et on l'affecte\n  U.NBSP =\n    Settings.settingForKey(settingsList.USE_NNBSP.ID) == true\n      ? U.NNBSP\n      : U.WNBSP\n\n  string = string\n    .replace(\n      // REMPLACEMENTS\n\n      // points de suspension\n\n      REGEX_ELLIPSIS,\n      match => {\n        console.log('points de suspension')\n        count++\n        return U.ELLIPSIS\n      }\n    )\n    //incises intelligentes\n    .replace(/([^0-9]\\s)--?(\\s?[^0-9])/, (match, $1, $2, $3) => {\n      console.log('incises intelligentes')\n      count++\n      return `${$1}–${$1}`\n    })\n    // puces en début de ligne\n    .replace(/(^|\\n|\\r)--?/, (match, $1) => {\n      console.log('puces en début de ligne')\n      count++\n      return '–'\n    })\n    //  n° --> №\n    .replace(/n°/, (match, $1, $2, $3) => {\n      count++\n      console.log('n°')\n      return '№'\n    })\n    // 1/2, 1/3, 1/4 --> caractères dédiés pour ces fractions\n    .replace(/(\\s|\\w|^)1\\/2(\\s|\\w|$)/, (match, $1, $2) => {\n      count++\n      console.log('1/2')\n      return `${$1}½${$2}`\n    })\n    .replace(/(\\s|\\w|^)1\\/3(\\s|\\w|$)/, (match, $1, $2) => {\n      count++\n      console.log('1/3')\n      return `${$1}⅓${$2}`\n    })\n    .replace(/(\\s|\\w|^)1\\/4(\\s|\\w|$)/, (match, $1, $2) => {\n      count++\n      console.log('1/4')\n      return `${$1}¼${$2}`\n    })\n    // 1er --> ordinal en exposant\n    .replace(/\\b1er?\\b/, (match, $1, $2) => {\n      count++\n      console.log('1er --> ordinal en exposant')\n      return `1ᵉʳ`\n    })\n    //2e --> ordinal en exposant\n    .replace(/(?!1\\b)(\\d+)e\\b/, (match, $1, $2) => {\n      count++\n      console.log('2e --> ordinal en exposant')\n      return `${$1}ᵉ`\n    })\n    .replace(/(\\w)\\'/, (match, $1, $2, $3) => {\n      console.log('apostrophe droit par apostrophe courbe')\n      count++\n      return $1 + '\\u2019'\n    })\n    //  ESPACES INSÉCABLES\n\n    // remplace \" par «\n    .replace(DOUBLE_QUOTE_OPEN, (match, $1, $2) => {\n      count++\n\n      let adj = $2 || ''\n      //console.log(adj)\n      return U.OPENING_QUOTE + adj\n    })\n    //remplace \" par »\n    .replace(DOUBLE_QUOTE_CLOSE, (match, $1, $2) => {\n      count++\n      let adj = $1 || $2 || ''\n      return adj + U.CLOSING_QUOTE\n    })\n    //ajoute espace après «\n    .replace(NBSP_AFTER_QUOTE, (match, $1, $2, $3, $4) => {\n      console.log('//après «')\n      count++\n      return $1 + $2 + U.NBSP + $4\n    })\n    //espaces fines insécables avant ? ! ; :\n    .replace(NBSP_DOUBLE_PUNCTUATION, (match, $1, $2, $3, $4) => {\n      console.log('espaces fines insécables avant ? ! ; :')\n      count++\n      return $1 + U.NBSP + $3 + $4\n    })\n    //ajoute espace avant »\n    .replace(NBSP_BEFORE_QUOTE, (match, $1, $2) => {\n      console.log('//avant »')\n      count++\n      let adj = $1 || $2 || ''\n      console.log('adj : ', adj)\n      return adj + U.NBSP + U.CLOSING_QUOTE\n    })\n    //avant %\n    .replace(/(\\d+)\\s?\\%/, (match, $1, $2) => {\n      console.log('//avant %')\n      count++\n      return `${$1}${U.NBSP}%`\n    })\n    //avant $£€\n    .replace(/(\\d+)\\s?([$£€])/, (match, $1, $2, $3) => {\n      console.log('/avant $£€')\n      count++\n      return `${$1}${U.NBSP}${$2}`\n    })\n  // /(\\d{3})( |\\D|$)\", function (match, p1, p2) {\n  //     console.log('milliers')\n  //     count++;\n  //     return `${p1}${U.NNBSP}`;\n  // })\n\n  return {\n    string: string,\n    count: count,\n  }\n}\n\n//fonction qui prend le texte du calque sélectionné,invoque replaceString() et compte le temps écoulé. Invocable lors de textChanged\nexport function fixLayer(context) {\n  // Si le remplacement automatique est désactivé dans les paramètres, on quitte la fonction\n  let autoReplaceActivated = Settings.settingForKey(\n    settingsList.AUTO_REPLACE.ID\n  )\n\n  if (!autoReplaceActivated) {\n    return\n  }\n\n  const startDate = new Date()\n  //let selection = sketch.fromNative(context.actionContext.layer);\n  let selection = document.selectedLayers.layers[0]\n  console.log(selection)\n  let newText = replaceString(selection.text)\n  selection.text = newText.string\n\n  let count = newText.count\n  const endDate = new Date()\n  const duration = (endDate.getTime() - startDate.getTime()) / 1000\n  if (count > 0 && Settings.settingForKey(settingsList.DEBUG.ID)) {\n    sketch.UI.message(`${count} substitution(s) done in ${duration}`, document)\n  }\n\n  if (\n    Settings.settingForKey(settingsList.USE_NNBSP.ID) &&\n    RegExp(U.NNBSP).test(selection)\n  ) {\n    console.log(\"replaceWNBSPbyNNBSP n'a pas marché\")\n  }\n  if (\n    !Settings.settingForKey(settingsList.USE_NNBSP.ID) &&\n    RegExp(U.WNBSP).test(selection)\n  ) {\n    console.log(\"replaceNNBSPbyWNBSP n'a pas marché\")\n  }\n}\n","// traversal of the document module by https://github.com/thierryc/Sketch-Find-And-Replace\n// Translated from SketchScript to JS.\n\nlet textLayers = [];\nexport function searchInLayer(layer, inSymbolMaster) {\n  // Determine the type of layer we're looking at\n\n  switch (layer.type) {\n    // Text layer - this is the important one\n    case \"Text\":\n      // log(layer.stringValue());\n\n      textLayers.push(layer);\n\n      break;\n\n    // If we've started our search at the document root, loop through the pages\n    case \"Document\":\n      var documentPages = layer.pages;\n      for (var i = 0; i < [documentPages.length]; i++) {\n        searchInLayer(documentPages[i], false);\n      }\n      break;\n\n    // Otherwise everything below that is an alias for layers anyway so we can treat them the same and loop through any sublayers\n    case \"Page\":\n    case \"Group\":\n    case \"Artboard\":\n      var sublayers = layer.layers;\n      for (var i = 0; i < [sublayers.length]; i++) {\n        searchInLayer(sublayers[i], false);\n      }\n      break;\n\n    case MSSymbolMaster:\n      if (inSymbolMaster != true) break;\n      var sublayers = layer.layers;\n      for (var i = 0; i < [sublayers.length]; i++) {\n        searchInLayer(sublayers[i], inSymbolMaster);\n      }\n      break;\n\n    // case MSSymbolInstance:\n    //   searchInSymbols(layer);\n    //   break;\n  }\n  return textLayers;\n}\n\n// function searchInSymbols(symbol) {\n//     var existingOverrides = symbol.overrides() || NSDictionary.dictionary();\n//     var overrides = NSMutableDictionary.dictionaryWithDictionary(existingOverrides);\n//     var keys = overrides.allKeys();\n\n//     for (var i = 0; i < keys.count(); i++) {\n//       var index = keys.objectAtIndex(i);\n//       if(overrides[index].class().isSubclassOfClass_(NSMutableDictionary.class()) ) {\n//           overrides[index] = searchInSymbolsInception(overrides[index]);\n//       } else if(overrides[index].class().isSubclassOfClass_(NSString.class()) ) {\n//         if (overrides[index] && overrides[index].trim() && overrides[index].trim().match(matchRegex)) {\n//           itemsMatched++;\n//           overrides[index] = replaceValue(overrides[index], textToReplace);\n//         }\n//       }\n//     }\n//     symbol.overrides = overrides;\n// }\n\n// function searchInSymbolsInception(overrides) {\n//   var keys = overrides.allKeys();\n//   for (var i = 0; i < keys.count(); i++) {\n//     var index = keys.objectAtIndex(i);\n//     if(overrides[index].class().isSubclassOfClass_(NSMutableDictionary.class()) ) {\n//         overrides[index] = searchInSymbolsInception(overrides[index]);\n//     } else if(overrides[index].class().isSubclassOfClass_(NSString.class()) ) {\n//       if (overrides[index].trim() && overrides[index].trim().match(matchRegex)) {\n//         itemsMatched++;\n//         overrides[index] = replaceValue(overrides[index], textToReplace);\n//       }\n//     }\n//   }\n//   return overrides;\n// }\n","module.exports = require(\"sketch\");","module.exports = require(\"sketch/settings\");"],"sourceRoot":""}